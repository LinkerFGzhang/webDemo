# 项目文档

***
## API返回说明
### 以`json`方式返回数据
```json
{
    "status": 0,
    "info": "相关说明",
    "data": Json数据
}
```

status: 状态码，0 表示成功；&gt; 表示错误；&lt; 表示异常。

info: 提示信息，可输出给用户

data: 请求的数据，以下描述的返回值无特殊说明都指这个。

### status 说明
| code | 说明 |
| --: | :-- |
| 0 | 成功 |
| 1 | 失败 |
| 2 | 用户原因导致的错误 |
| 3 | 用户权限不足 |
| 4 | 该用户还在使用初始密码，需要修改密码后才能操作 |
|  |  |
| -1 | session过期 |
| -2 | 执行过程异常 |
| -3 | 业务逻辑异常 |

***
### 用户角色说明
| 条件 | 角色 | 权限 |
| --: | --: | :-- |
| user_id == 1 | 超级管理员 | 所有权限 |
| group_id == 1 | 管理员 | 对 **\[ group_id == 1 \]** 外的对象具有所有权限。(密码、token不可见) |
| group_id == 2 | 高级用户 | 可以 **\[ 创建 \]** 用户组，可以 **\[ 删除、修改、查看 \]** 自己的用户组；<br>可以 **\[ 创建、删除、修改、查看 \]** 自己用户组下的用户。（密码、token不可见） |
| group_id == 3 | 保留用户 |
| group_id >= 4 | 普通用户 | 可以 **\[ 修改、查看 \]** 自己的信息。（密码、token不可见） |

`注`: **\[ group_id == {1, 2, 3} \]** 的所有者是 **\[ user_id == 1 \]**&emsp;(owner_id = 1)

***
## 用户组

### 权限表
| option | handler.userId = 1 | handler.groupId = 1 | handler.groupId = 2 | handler.groupId = 3 | handler.groupId > 3 |
| -- | -- | -- | -- | -- | -- |
| add | √ | √ | √ | × | × |
| remove | √ | target.groupId > 3 | target.ownerId == handler.userId | × | × |
| modify | √ | target.groupId > 1 | target.ownerId == handler.userId | × | × |
| detail | √ | √ | target.ownerId == handler.userId **or**<br> target.groupId == handler.groupId | target.groupId == handler.groupId | target.groupId == handler.groupId |
| list | √ | √ | target.ownerId == handler.userId | × | × |

## 用户

### 权限表
| option | handler.userId = 1 | handler.groupId = 1 | handler.groupId = 2 | handler.groupId = 3 | handler.groupId > 3 |
| -- | -- | -- | -- | -- | -- |
| add | √ | target.groupId > 1 | target.group.ownerId == handler.userId | × | × |
| remove | √ | target.groupId > 1 | target.group.ownerId == handler.userId | × | × |
| modify | √ | target.groupId > 1 **or**<br> target.userId == handler.userId | target.group.ownerId == handler.userId **or**<br> target.userId == handler.userId | target.userId == handler.userId | target.userId == handler.userId |
| detail | √ | target.groupId > 1 **or**<br> target.userId == handler.userId | target.group.ownerId == handler.userId **or**<br> target.userId == handler.userId | target.userId == handler.userId | target.userId == handler.userId |
| list | √ | target.groupId > 1 | target.ownerId == handler.userId | × | × |

## 文件

### 权限表
| option | handler.userId = 1 | handler.groupId = 1 | handler.groupId = 2 | handler.groupId = 3 | handler.groupId > 3 |
| -- | -- | -- | -- | -- | -- |
| add | √ | √ | √ | √ | √ |
| remove | √ | √ | target.userId == handler.userId **or**<br> target.group.ownerId == handler.userId | target.userId == handler.userId | target.userId == handler.userId |
| modify | √ | √ | target.userId == handler.userId **or**<br> target.group.ownerId == handler.userId | target.userId == handler.userId | target.userId == handler.userId |
| detail | √ | √ | √ | √ | √ |
| list | √ | √ | √ | √ | √ |

## 摄像头

### 权限表
| option | handler.userId = 1 | handler.groupId = 1 | handler.groupId = 2 | handler.groupId = 3 | handler.groupId > 3 |
| -- | -- | -- | -- | -- | -- |
| add | √ | √ | √ |   | √ |
| remove | √ | √ | target.userId == handler.userId **or**<br> target.user.group.ownerId == handler.userId |   | target.userId == handler.userId |
| modify | √ | √ | target.userId == handler.userId **or**<br> target.user.group.ownerId == handler.userId |   | target.userId == handler.userId **or**<br> target.userId == handler.group.ownerId **or**<br> target.user.groupId == handler.groupId |
| detail | √ | √ | target.userId == handler.userId **or**<br> target.user.group.ownerId == handler.userId |   | target.userId == handler.userId **or**<br> target.userId == handler.group.ownerId **or**<br> target.user.groupId == handler.groupId |
| list | √ | √ | target.userId == handler.userId **or**<br> target.user.group.ownerId == handler.userId |   | target.userId == handler.userId **or**<br> target.userId == handler.group.ownerId **or**<br> target.user.groupId == handler.groupId |

***
